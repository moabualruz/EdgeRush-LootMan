# Test configuration for integration tests
# Note: spring.profiles.active cannot be set in profile-specific files
# It's set via @TestPropertySource or @ActiveProfiles in test classes

# Disable config validation for tests
spring.config.import=optional:file:.env.local

# Use PostgreSQL for tests (requires docker-compose up postgres)
spring.datasource.url=jdbc:postgresql://localhost:5432/edgerush_test
spring.datasource.username=edgerush
spring.datasource.password=edgerush
spring.datasource.driver-class-name=org.postgresql.Driver

# Flyway configuration for tests
spring.flyway.locations=classpath:db/migration/postgres
spring.flyway.baseline-on-migrate=true

# Sync configuration for tests
sync.cron=0 0 4 * * *
sync.run-on-startup=false
sync.wowaudit.base-url=https://wowaudit.com
sync.wowaudit.guild-profile-uri=https://wowaudit.com/test-guild
sync.wowaudit.api-key=test-api-key

# Warcraft Logs test configuration (disabled for tests)
warcraft-logs.enabled=false
warcraft-logs.client-id=test-client-id
warcraft-logs.client-secret=test-client-secret
warcraft-logs.base-url=https://www.warcraftlogs.com/api/v2
warcraft-logs.token-url=https://www.warcraftlogs.com/oauth/token
warcraft-logs.max-retries=3
warcraft-logs.retry-delay-ms=1000
warcraft-logs.max-concurrent-requests=5
warcraft-logs.request-timeout-seconds=30

# Raidbots test configuration (disabled for tests)
raidbots.enabled=false
raidbots.base-url=https://www.raidbots.com

# Encryption key for tests
encryption.key=test-32-byte-key-for-testing!!

# Logging for tests
logging.level.com.edgerush.datasync=DEBUG
logging.level.org.springframework.web=DEBUG

# Actuator configuration for tests
management.endpoints.web.exposure.include=*
management.endpoint.health.show-details=always
management.security.enabled=false

# Disable OAuth2 and Security for tests
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.security.oauth2.client.servlet.OAuth2ClientAutoConfiguration,\
  org.springframework.boot.autoconfigure.security.oauth2.client.reactive.ReactiveOAuth2ClientAutoConfiguration,\
  org.springframework.boot.autoconfigure.security.reactive.ReactiveSecurityAutoConfiguration,\
  org.springframework.boot.autoconfigure.security.reactive.ReactiveUserDetailsServiceAutoConfiguration

# Use servlet stack for tests (MockMvc compatibility)
spring.main.web-application-type=servlet

# Allow bean definition overriding for tests
spring.main.allow-bean-definition-overriding=true

# API configuration for tests
api.admin-mode.enabled=true
api.rate-limit.enabled=false
jwt.secret=test-secret-key-must-be-at-least-256-bits-long-for-security-purposes